<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="inherit_sale_quotations" name="template_name" inherit_id="l10n_din5008.external_layout_din5008">
        <!-- logo position change -->
        <xpath expr="//table[contains(@class,'company_header')]" position="replace">
            <div t-if="doc">
                <img  class="header-logo-image" t-attf-src="data:image/*;base64,{{doc.company_id.logo}}"  height="110px" width="90px" />
            </div>
        </xpath>
        <!--customer information block -->
        <xpath expr="//div[contains(@t-attf-class, 'din_page invoice_note')]" position="replace">
            <div t-if="o" t-attf-class="din_page quotation-page invoice_note article o_company_#{company.id}_layout {{'o_report_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  ''}} #{'din_page_pdf' if report_type == 'pdf' else ''}"
                     t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});"
                     t-att-data-oe-model="o and o._name"
                     t-att-data-oe-id="o and o.id">
                <div class="title_source_div">
                    <strong class="title_source">
                        <span t-if="o.state not in ['draft','sent']">AUFTRAGSBESTÄTIGUNG
                            <br/>N .:
                            <span t-field="o.name"/></span>
                        <span t-if="o.state in ['draft','sent']">OFFERT
                            <br/>N .:
                            <span t-field="o.name"/></span>
                    </strong>
                </div>
                <div class="row information_block">
                    <div class="col-5 title">
                        <strong >
                            <t t-if="o.partner_id">
                                <span t-field="o.partner_id.name"/>
                            </t>
                        </strong>
                        <br/>
                        <span t-field="o.partner_id.street"/>
                        <br/>
                        <span t-field="o.partner_id.zip"/>
                        <span t-field="o.partner_id.state_id.code"/>
                        <span t-field="o.partner_id.city"/>
                        <br/>
                        <span t-field="o.partner_id.country_id"/>
                    </div>
                    <div class="col-7">
                        <div class="row">
                            <!-- Right-aligned column -->
                            <div class="col-4 text-start">
                                <!-- State-based labels -->
                                <span t-if="o.state in ['draft','sent']">Datum
                                    <br/>
                                </span>
                                <span t-if="o.state not in ['draft','sent']">Datum
                                    <br/>
                                </span>
                                <span t-if="o.state in ['draft','sent']">Ansprechpartner
                                    <br/>
                                </span>
                                <span t-if="o.state not in ['draft','sent']">Ansprechpartner
                                    <br/>
                                </span>
                                <!-- User contact details -->
                                <span t-if="o.user_id.phone">Telefon
                                    <br/>
                                </span>
                                <span t-if="o.user_id.email">Email</span>
                            </div>
                            <!-- Left-aligned column -->
                            <div class="col-6 text-start">
                                <!-- Date based on state -->
                                <span t-if="o.state in ['draft','sent']">
                                    <span t-field="o.create_date" t-options="{'widget':'date'}"/>
                                    <br/>
                                </span>
                                <span t-if="o.state not in ['draft','sent']">
                                    <span t-field="o.date_order" t-options="{'widget':'date'}"/>
                                    <br/>
                                </span>
                                <!-- User details -->
                                <span t-if="o.state in ['draft','sent']">
                                    <span t-field="o.user_id"/>
                                    <br/>
                                </span>
                                <span t-if="o.state not in ['draft','sent']">
                                    <span t-field="o.user_id.name"/>
                                    <br/>
                                </span>
                                <!-- Contact details -->
                                <span t-if="o.user_id.phone">
                                    <span t-field="o.user_id.phone"/>
                                    <br/>
                                </span>
                                <span t-if="o.user_id.email">
                                    <span t-field="o.user_id.email"/>
                            </span>
                            </div>
                            <div class="col-2 logo-image">
                               
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Notes -->
                <div class="note_block">
                    <t t-if="o.state in ['draft','sent']">
                        <b>
                            <span style="line-height: 250%; " t-field="o.sale_subject"/>
                        </b>
                        <br/>
                        <span style="line-height: 200%; " t-field="o.cover_note_quot"/>
                        <br/>
                    </t>
                    <t t-if="o.state not in ['draft','sent']">
                        <b>
                            <span style="line-height: 200%; " t-field="o.sale_order_subject"/>
                        </b>
                        <br/>
                        <span style="line-height: 200%; " t-field="o.cover_note_sale"/>
                        <br/>
                    </t>
                </div>
                <br/>
                <br/>
                <!-- Product Table -->
                <table class="table table-sm o_main_table table-borderless">
                    <thead style="border-bottom: 0.5px solid black;">
                        <tr>
                            <th class="text-start"  style="width:100px; border-top: 0px solid white !important;border-bottom: 1px solid black; width:50px;">Position</th>
                            <th class="text-start" style="border-top: 0px solid white !important;border-bottom: 1px solid black;">Produkt</th>
                            <th class="text-start" style="border-top: 0px solid white !important;border-bottom: 1px solid black;"></th>
                            <th class="text-start" style="border-top: 0px solid white !important;border-bottom: 1px solid black;">Preis/Stück</th>
                            <th class="text-start" style="border-top: 0px solid white !important;border-bottom: 1px solid black;">Stück</th>
                            <th class="text-start" style="border-top: 0px solid white !important;border-bottom: 1px solid black;">Disc.</th>
                            <th class="text-start" style="border-top: 0px solid white !important;border-bottom: 1px solid black;">Summe</th>
                        </tr>
                    </thead>
                    <tbody class="sale_tbody">
                        <t t-set="current_subtotal" t-value="0"/>
                        <t t-foreach="o.order_line" t-as="line">
                            <tr style="border-bottom: 0.5px solid #dcdcdc;">
                                <td style="vertical-align: top;">
                                    <strong>
                                        <span t-field="line.position"/>
                                    </strong>
                                </td>
                                <td style="vertical-align: top;">
                                        <span t-field="line.product_id.name"/><br/>
                                        <t t-foreach="line.product_id.product_template_attribute_value_ids" t-as="attribute">
                                            <span t-field="attribute.display_name"/><br/>
                                        </t>
                                      
                                </td>
                                <td style="vertical-align: middle;">
                                    <img t-if="line.product_id.image_1920" t-att-src="image_data_uri(line.product_id.image_1920)" width="50px" height="50px" />
                                </td>
                                <td class="text-center" style="text-align: center; vertical-align: middle;">
                                    <span t-field="line.price_unit"/>
                                </td>
                                <td class="text-center" style="vertical-align: middle;">
                                    <t t-esc="int(line.product_uom_qty)"/>
                                </td>
                                <td class="text-center" style="vertical-align: middle;">
                                    <span t-field="line.discount"/>%
                                </td>
                                <td class="text-center" style="vertical-align: middle;">
                                    <span t-field="line.price_subtotal"/>
                                </td>
                            </tr>
                        </t>
                    </tbody>
                </table>
                <br/>
                <br/>
                <table class="table" style="border-bottom: 0.5px solid black !important;">
                    <t t-set="discount" t-value="sum(line.price_subtotal for line in o.order_line if line.price_subtotal and line.price_subtotal &lt; 0) or 0"/>
                    <t t-set="total_price" t-value="sum(line.price_subtotal for line in o.order_line if line.price_subtotal and line.price_subtotal &gt; 0)"/>
                    <tr>
                        <td style="padding:0 0 0 10px; margin:0px; border-top: 1px solid black; vertical-align: middle;">Summe netto</td>
                        <td class="text-end" style="padding:0 10px 0 0; margin:0px; border-top: 1px solid black; vertical-align: middle;">
                            <span t-field="o.amount_untaxed"/>
                        </td>
                    </tr>
                    <tr t-if="discount!=0" style="height: -2px;">
                        <td style="padding:0 0 0 10px; margin:0px; vertical-align: middle;">Konditionen
                            <![CDATA[&nbsp;]]>
                            <span t-esc="discount if discount==0 else round(abs(discount)/total_price*100)"/>%
                        </td>
                        <td class="text-end" style="padding:0 10px 0 0; margin:0px; vertical-align: middle;">
                            <span t-esc="abs(discount)"/> €
                        </td>
                    </tr>
                    <tr t-if="discount!=0" style="height: -2px;">
                        <td style="padding:0 0 0 10px; margin:0px; vertical-align: middle;">Zwischensumme</td>
                        <td class="text-end" style="padding:0 10px 0 0; margin:0px; vertical-align: middle;">
                            <span t-esc="total_price"/> €
                        </td>
                    </tr>
                    <tr style="height: 2px;">
                        <t t-if="o.amount_tax &gt; 0">
                            <t t-set="taxes" t-value="o.show_tax()"/>
                            <td style="padding:0 0 0 10px; margin:0px; vertical-align: middle;">
                                <t t-foreach="taxes['tax_groups']" t-as="tax_des">
                                    <span t-esc="tax_des"/>
                                </t>
                            </td>
                            <td class="text-end" style="padding:0 10px 0 0; margin:0px; vertical-align: middle;">
                                <span t-esc="round(o.amount_tax,2)"/> €
                            </td>
                        </t>
                    </tr>
                    <tr style="height: 20px;">
                        <td style="padding:0 0 0 10px; margin:0px; vertical-align: middle;" width="10">
                            <b>Gesamtsumme</b>
                        </td>
                        <td class="text-end" style="padding:0 10px 0 0; margin:0px; vertical-align: middle;" width="10">
                            <b>
                                <span t-field="o.amount_total"/>
                            </b>
                        </td>
                    </tr>
                </table>
                <br/>
                <div style="text-align:justify;">
                    <p>Etwaige Produktbilder sind eine Abbildung des offerierten Modells, aber nicht unbedingt der gewählten Ausführung. 
                    Preise verstehen sich in Euro, pro Stück exklusive Mehrwertsteuer, gültig für die angebotene Stückzahl</p>
                </div>
                <br/>
                <div class="col-md-12" name="total" style="margin-right:100px;"/>
                <div class="clearfix"/>
                <div class="row pb-2">
                    <div class="col-2">
                        <p>
                            <strong style="padding-right:30px;">Lieferung:</strong>
                        </p>
                    </div>
                    <div class="col-10">
                        <p>
                            <t t-if="o.state in ['draft','sent']">
                                <t t-esc="o.delivery_term_quot"/>
                        </t>
                            <t t-else="">
                                <t t-esc="o.delivery_term_sale"/>
                        </t>
                        </p>
                    </div>
                </div>
                <div  class="row pb-2">
                    <div class="col-2">
                        <p>
                            <strong style="padding-right:30px;">Lieferzeit:</strong>
                        </p>
                    </div>
                    <div class="col-10">
                        <p>
                            <t t-if="o.state in ['draft','sent']">
                                <t t-esc="o.delivery_time_quot"/>, Jede Lieferung erfolgt unter dem Vorbehalt, dass wir selbst richtig und rechtzeitig beliefert werden. Für verspätete Lieferungen können wir nicht verantwortlich gemacht werden.
                      </t>
                            <t t-else="">
                                <t t-esc="o.delivery_time_sale"/> ,jede Lieferung erfolgt unter dem Vorbehalt, dass wir selbst richtig und rechtzeitig beliefert werden. Für verspätete
                            Lieferungen können wir nicht verantwortlich gemacht werden. Sobald die Ware in unserem Lager eingetroffen ist, werden
                            wir uns umgehend mit lhnen in Verbindung setzten, um einen Liefer/Auftragsklarheit zu vereinbaren. Die Lieferzeit beginnt
                            mit Auftragsklarheit und dem Eintreffen einer vereinbarten Anzahlung. Bei Selbtabholung ist die bestellte Ware innerhalb
                            von 7 Tagen von unserem Lager abzuholen. Bei verspäteter Abholung fallen Lagerkosten von €6,00 inkl. Mwst. pro Tag an.
                      </t>
                        </p>
                    </div>
                </div>
                <div class="row pb-2">
                    <div class="col-2">
                        <p>
                            <strong style="padding-right:30px;">Zahlungsziel:</strong>
                        </p>
                    </div>
                    <div class="col-10">
                        <p>
                            <t t-if="o.payment_term_id" t-esc="o.payment_term_id.name"/> Bei Zahlungszielüberschreitung werden 1,5% Monat verrechnet.Die Ware bleibt bis zur vollständigen Bezahlung in unserem Eigentum.
                        </p>
                    </div>
                </div>
                <div t-if="o.state in ['draft','sent']" class="row pb-2">
                    <div class="col-2">
                        <p>
                            <strong style="padding-right:30px;">Gültigkeit:</strong>
                        </p>
                    </div>
                    <div class="col-10">
                        <p>
                        Das Angebot ist gültig bis
                            <t t-if="o.validity_date" t-esc="o.validity_date"/>
                        </p>
                    </div>
                </div>
                <br/>
                <div t-if="o.state not in ['draft','sent']" class="row">
                    <div class="col-6">
                        <p>
                            <strong>
                                <u>Lieferadresse</u>
                            </strong>
                        </p>
                        <div>
                            <p>
                                <span style="display:block;">
                                    <span t-field="o.partner_shipping_id.parent_id.name" />,</span>
                                <span t-field="o.partner_shipping_id.name" style="display:block;"/>
                                <div t-field="o.partner_shipping_id"
                                t-options='{"widget": "contact", "fields": ["address"], "no_marker": True}'/>
                            </p>
                        </div>
                    </div>
                    <div class="col-6">
                        <p>
                            <strong>
                                <u>Rechungsadresse</u>
                            </strong>
                        </p>
                        <div>
                            <p>
                                <span style="display:block;">
                                    <span t-field="o.partner_invoice_id.parent_id.name"/>,</span>
                                <span t-field="o.partner_invoice_id.name" style="display:block;"/>
                                <div t-field="o.partner_invoice_id"
                            t-options='{"widget": "contact", "fields": ["address"], "no_marker": True}'/>
                            </p>
                        </div>
                    </div>
                </div>
                <br/>
                <br/>
                <div>
                    <t t-if="o.state in ['draft','sent']">
                        <p>
                        Für alle Lieferungen gelten unsere Allgemeinen Geschäftsbedingungen, hinterlegt unter agb.pfau1010.com. Wir hoffen,
                        dass unser Angebot Ihren Vorstellungen entspricht. Sie erreichen uns innerhalb unserer Geschäftszeiten unter 01 535 40
                        75 oder auch per email office@pfau1010.com.
                        </p>
                    </t>
                    <t t-else="">
                        <p>
                        Wir bitten um Bestätigung der Auftragsbestätigung zu den vereinbarten Bedingungen und Retournierung.
                            <br/>
                            <br/>
                            <br/>
                            <br/>
                            <br/>
                            <br/>
                        

                        --------------------------------------------------------------------
                            <br/>
                        Datum, Name and Unterschrift
                        </p>
                    </t>
                </div>
                <br/>
                <br/>
                <div>
                    <t t-esc="o.user_id.name"/>
                </div>
                <div class="footer" >
                    <div class="text-center">
                    <p class="footer-size">PFAU OG, GESELLSCHAFT FÜR OBJEKTEINRICHTUNG UND INNENRAUMGESTALTUNG, AM GESTADE, 1010 WIEN
                    TELEFON: +43 -1- 535 40 75, FAX DW 9, WWW.PFAU1010.COM, OFFICE@PFAU1010.COM, UID-NR. ATU 10249006, FN 9447v HG WIEN
                    RAIFFEISENLANDESBANK NÖ-WIEN KTdoc.-NR.: 10.384.774, BLZ: 32000, IBAN: AT 8832 000 000 1038 4774, BIC: RLNWATWW</p>
                    </div>
                </div>
            </div>
        </xpath>
    </template>
</odoo>