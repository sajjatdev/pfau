<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="inherit_sale_quotations" name="template_name" inherit_id="l10n_din5008.external_layout_din5008">
        <!-- logo position change -->
        <xpath expr="//table[contains(@class,'company_header')]" position="replace">
            <img class="header-logo-image" src="/pfau/static/src/imags/company_logo.png" height="130px"/>
        </xpath>
        <!--customer information block -->
        <xpath expr="//div[contains(@t-attf-class, 'din_page invoice_note')]" position="replace">
            <t t-if="o and o.partner_id and o.partner_id.lang">
                <t t-set="doc" t-value="o.with_context({'lang': o.partner_id.lang})"/>
                </t>
            <t t-else="">
                <t t-set="doc" t-value="o"/>
                </t>
            <t t-if="doc">
                <div t-if="'WH/OUT/' not in doc.name and  '/' not in doc.name and  'I' not in doc.name"
                    t-attf-class="din_page quotation-page invoice_note article o_company_#{company.id}_layout {{'o_report_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  ''}} #{'din_page_pdf' if report_type == 'pdf' else ''}"
                    t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});"
                    t-att-data-oe-model="doc and doc._name"
                    t-att-data-oe-id="doc and doc.id">
                    <div class="title_source_div">
                        <strong class="title_source">
                            <span t-translation="true" t-if="doc.state not in ['draft', 'sent']">
                                <t t-if="'P' not in doc.name" t-translation="true">ORDER CONFIRMATION</t>
                                <t t-if="'P' in doc.name" t-translation="true" >PURCHASE ORDER</t>
                                <br/>N.:
                                <span t-field="doc.name"/>
                        </span>
                            <span t-translation="true" t-if="doc.state in ['draft', 'sent']">
                                <t t-if="'P' not in doc.name" t-translation="true">QUOTATION</t>
                                <t t-if="'P' in doc.name" t-translation="true">PURCHASE ORDER</t>
                                <br/>N.:
                                <span t-field="doc.name"/>
                        </span>
                        </strong>
                    </div>
                    <div class="row information_block">
                        <div class="col-5 title" style="padding-right:20px;">
                            <strong>
                                <t t-if="doc.partner_id">
                                    <span t-field="doc.partner_id.name"/>
                                </t>
                            </strong>
                            <br/>
                            <span t-field="doc.partner_id.street"/>
                            <br/>
                            <span t-field="doc.partner_id.zip"/>
                            <span t-field="doc.partner_id.state_id.code"/>
                            <span t-field="doc.partner_id.city"/>
                            <br/>
                            <span t-field="doc.partner_id.country_id"/>
                        </div>
                        <div t-if="'P' not in doc.name" class="col-7">
                            <div class="row">
                                <!-- Right-aligned column -->
                                <div class="col-4 text-start">
                                    <!-- State-based labels -->
                                    <span t-if="doc.state in ['draft', 'sent']">
                                        <t t-translation="true">Date</t>
                                        <br/>
                                    </span>
                                    <span t-if="doc.state not in ['draft', 'sent']">
                                        <t t-translation="true">Order Date</t>
                                        <br/>
                                    </span>
                                    <span t-if="doc.state in ['draft', 'sent']">
                                        <t t-translation="true">Contact Person</t>
                                        <br/>
                                    </span>
                                    <span t-if="doc.state not in ['draft', 'sent']">
                                        <t t-translation="true">Sales Person</t>
                                        <br/>
                                    </span>
                                    <!-- User contact details -->
                                    <span t-if="doc.user_id.phone" t-translation="on">
                                        <t t-translation="true">Phone</t>
                                        <br/>
                                    </span>
                                    <span t-if="doc.user_id.email" t-translation="on">
                                        <t t-translation="true">Email</t>
                                        <!-- Same in both languages -->
                                    </span>
                                </div>
                                <!-- Left-aligned column -->
                                <div class="col-6 text-start">
                                    <!-- Date based on state -->
                                    <span t-if="doc.state in ['draft','sent']">
                                        <span t-field="doc.create_date" t-options="{'widget':'date'}"/>
                                        <br/>
                                    </span>
                                    <span t-if="doc.state not in ['draft','sent']">
                                        <span t-field="doc.date_order" t-options="{'widget':'date'}"/>
                                        <br/>
                                    </span>
                                    <!-- User details -->
                                    <span t-if="doc.state in ['draft','sent']">
                                        <span t-field="doc.user_id"/>
                                        <br/>
                                    </span>
                                    <span t-if="doc.state not in ['draft','sent']">
                                        <span t-field="doc.user_id.name"/>
                                        <br/>
                                    </span>
                                    <!-- Contact details -->
                                    <span t-if="doc.user_id.phone">
                                        <span t-field="doc.user_id.phone"/>
                                        <br/>
                                    </span>
                                    <span t-if="doc.user_id.email">
                                        <span t-field="doc.user_id.email"/>
                                </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Notes -->
                    <div t-if="'P' not in doc.name" class="note_block">
                        <t t-if="doc.state in ['draft','sent']">
                            <b>
                                <span style="line-height: 250%; " t-if="'sale_subject' in doc" t-field="doc.sale_subject"/>
                            </b>
                            <br/>
                            <span style="line-height: 200%; " t-if="'cover_note_quot' in doc"
                              t-field="doc.cover_note_quot"/>
                            <br/>
                        </t>
                        <t t-if="o.state not in ['draft','sent']">
                            <b>
                                <span style="line-height: 200%; " t-if="'sale_order_subject' in doc"
                                  t-field="doc.sale_order_subject"/>
                            </b>
                            <br/>
                            <span style="line-height: 200%; " t-if="'cover_note_sale' in doc"
                              t-field="doc.cover_note_sale"/>
                            <br/>
                        </t>
                    </div>
                    <div t-if="'P' in doc.name">
                        <br/>
                        <br/>
                    </div>
                    <div t-if="'P' in doc.name" class="row">
                        <div class="col-3">
                            <span>
                                <strong>
                                    <span t-translation="true">Our Order Reference</span>
                                </strong>
                                <br/>
                                <span t-esc="doc.name"/>
                        </span>
                        </div>
                        <div class="col-3">
                            <span>
                                <strong>
                                    <span t-translation="true">Order Date</span>
                                </strong>
                                <br/>
                                <span t-field="doc.date_order" t-options="{'widget':'date'}"/>
                        </span>
                        </div>
                    </div>
                    <br/>
                    <br/>
                    <!-- Product Table -->
                    <t t-set="display_discount" t-value="any(l.discount for l in doc.order_line)"/>
                    <table class="table table-sm o_main_table table-borderless">
                        <thead style="border-bottom: 0.5px solid black;">
                            <tr>
                                <th t-if="'P' not in doc.name" class="text-start"
                            style="width:100px; border-top: 0px solid white !important; border-bottom: 1px solid black; width:50px;">
                                    <t t-translation="true">Position</t>
                                </th>
                                <th class="text-start" style="border-top: 0px solid white !important; border-bottom: 1px solid black;">
                                    <t t-translation="true">Product</t>
                                </th>
                                <th class="text-start" style="border-top: 0px solid white !important; border-bottom: 1px solid black;"/>
                                <th class="text-end" style="border-top: 0px solid white !important; border-bottom: 1px solid black;">
                                    <t t-translation="true">Price/Unit</t>
                                </th>
                                <th class="text-end" style="border-top: 0px solid white !important; border-bottom: 1px solid black;">
                                    <t t-translation="true">Quantity</t>
                                </th>
                                <th t-if="display_discount" class="text-end" style="border-top: 0px solid white !important; border-bottom: 1px solid black;">
                                    <t t-translation="true">Disc.</t>
                                </th>
                                <th class="text-end" style="border-top: 0px solid white !important; border-bottom: 1px solid black;">
                                    <t t-translation="true">Total</t>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="sale_tbody">
                            <t t-set="current_subtotal" t-value="0"/>
                            <t t-set="index" t-value="0"/>
                            <t t-foreach="doc.order_line" t-as="line">
                                <!-- Index Set -->
                                <t t-set="index" t-value="index+1"/>
                                <!-- Regular Product Line -->
                                <t t-if="not line.display_type">
                                    <tr t-if="line.price_unit &gt;= 0" t-attf-style="#{'' if index == len(doc.order_line) else 'border-bottom: 0.5px solid black;'}">
                                        <td t-if="'P' not in doc.name" style="vertical-align: top;">
                                            <strong>
                                                <span t-if="'position' in line" t-field="line.position"/>
                                            </strong>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <span t-field="line.product_id.name"/>
                                            <t t-if="'S' in doc.name">
                                                <br/>
                                                <span t-field="line.product_id.description_sale"/>
                                            </t>
                                            <t t-if="'P' in doc.name">
                                                <br/>
                                                <span t-field="line.name"/>
                                            </t>
                                            <br/>
                                            <t t-foreach="line.product_id.product_template_attribute_value_ids" t-as="attribute">
                                                <span t-field="attribute.display_name"/>
                                                <br/>
                                            </t>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <img t-if="line.product_id.image_1920" t-att-src="image_data_uri(line.product_id.image_1920)" width="50px" height="50px"/>
                                        </td>
                                        <td class="text-end" style="text-align: center; vertical-align: top;">
                                            <span>
                                                <span t-field="line.price_unit"/> €</span>
                                        </td>
                                        <td class="text-end" style="vertical-align: top;">
                                            <t t-esc="int(line.product_uom_qty)"/>
                                        </td>
                                        <td t-if="display_discount" class="text-end" style="vertical-align: top;">
                                            <span t-field="line.discount"/>%
                                        </td>
                                        <td class="text-end" style="vertical-align: top;">
                                            <span t-field="line.price_subtotal"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-elif="line.display_type == 'line_section'">
                                    <td colspan="99" t-attf-style="#{'' if index == len(doc.order_line) else 'border-bottom: 0.5px solid black;'}">
                                        <span t-field="line.name" t-options="{'widget': 'text'}">A section title</span>
                                    </td>
                                    <t t-set="current_section" t-value="line"/>
                                    <t t-set="current_subtotal" t-value="0"/>
                                </t>
                                <t t-elif="line.display_type == 'line_note'" >
                                    <td colspan="99" t-attf-style="#{'' if index == len(doc.order_line) else 'border-bottom: 0.5px solid black;'}">
                                        <span t-field="line.name" t-options="{'widget': 'text'}">A note, whose content usually applies to the section or product above.</span>
                                    </td>
                                </t>
                            </t>
                        </tbody>
                    </table>
                    <t t-set="discount"
                       t-value="sum(line.price_subtotal for line in doc.order_line if line.price_subtotal and line.price_subtotal &lt; 0) or 0"/>
                    <t t-set="total_price"
                       t-value="sum(line.price_subtotal for line in doc.order_line if line.price_subtotal and line.price_subtotal &gt; 0)"/>
                    <table class="table-sm o_main_table table-borderless" style="width:100%;">
                        <tr>
                            <td style="border-top: 0.5px solid black;">
                                <span t-translation="true">Net Total</span>
                            </td>
                            <td class="text-end" style="border-top: 0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(total_price).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr t-if="discount!=0">
                            <td style="border-top: 0.5px solid black;">
                                <span t-translation="true">Conditions</span>
                                <span t-esc="discount if discount==0 else round(abs(discount)/total_price*100)"/>%
                            </td>
                            <td class="text-end" style="border-top:  0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(round(discount,2)).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr t-if="discount!=0">
                            <td style="border-top: 0.5px solid black;">
                                <span t-translation="true">Subtotal</span>
                            </td>
                            <td class="text-end" style="border-top:  0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(doc.amount_untaxed).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr t-if="doc.amount_tax>0">
                            <td style="border-top: 0.5px solid black;">
                                <span t-translation="true">20% Tax.</span>
                            </td>
                            <td class="text-end" style="border-top: 0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(doc.amount_tax).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <td style="border-top: 0.5px solid black; border-bottom: 0.5px solid black;">
                                <strong>
                                    <span t-translation="true">Total</span>
                                </strong>
                            </td>
                            <td class="text-end" style="border-top: 0.5px solid black; border-bottom: 0.5px solid black;">
                                <strong>
                                    <span>
                                        <t t-esc="'{:,.2f}'.format(doc.amount_total).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                    </span>
                                </strong>
                            </td>
                        </tr>
                    </table>
                    <br/>
                    <br/>
                    <div t-if="'P' not in doc.name">
                        <br/>
                        <div style="text-align:justify;">
                            <p t-esc="doc.get_note()"/>
                        </div>
                        <br/>
                        <div class="col-md-12" name="total" style="margin-right:100px;"/>
                        <div class="clearfix"/>
                        <div class="row pb-2">
                            <div class="col-3">
                                <p>
                                    <strong style="padding-right:30px;" t-translation="true">
                                    Delivery:
                                </strong>
                                </p>
                            </div>
                            <div class="col-9">
                                <p>
                                    <t t-if="doc.state in ['draft','sent']">
                                        <t t-if="'delivery_term_quot' in doc" t-esc="doc.delivery_term_quot"/>
                                </t>
                                    <t t-else="">
                                        <t t-if="'delivery_term_sale' in doc" t-esc="doc.delivery_term_sale"/>
                                    </t>
                                </p>
                            </div>
                        </div>
                        <div class="row pb-2">
                            <div class="col-3">
                                <p>
                                    <strong style="padding-right:30px;" t-translation="true">
                                    Delivery Time:
                                </strong>
                                </p>
                            </div>
                            <div class="col-9">
                                <p>
                                    <t t-if="doc.state in ['draft','sent']"  t-translation="true">
                                        <t t-if="'delivery_time_quot' in doc" t-esc="doc.delivery_time_quot"/>,
                                        <t t-esc="doc.get_text_delivery_time_quot()"/>
                                    </t>
                                    <t t-else="" t-translation="true">
                                        <t t-if="'delivery_time_sale' in doc" t-esc="doc.delivery_time_sale"/>,
                                        <t t-esc="doc.get_text_delivery_time_sale()"/>
                                    </t>
                                </p>
                            </div>
                        </div>
                        <div class="row pb-2">
                            <div class="col-3">
                                <p>
                                    <strong style="padding-right:30px;" t-translation="true">
                                    Payment Terms:
                                </strong>
                                </p>
                            </div>
                            <div class="col-9">
                                <p t-translation="true">
                                    <t t-if="doc.payment_term_id" t-esc="doc.payment_term_id.name"/>
                                    <t t-esc="doc.get_text_payment_term_note()"/>
                                </p>
                            </div>
                        </div>
                        <div t-if="doc.state in ['draft','sent']" class="row pb-2">
                            <div class="col-3">
                                <p>
                                    <strong style="padding-right:30px;" t-translation="true">
                                    Validity:
                                </strong>
                                </p>
                            </div>
                            <div class="col-9">
                                <p t-translation="off">
                                Das Angebot ist gültig bis
                                    <t t-if="'validity_date' in doc and doc.validity_date" t-esc="doc.validity_date"/>
                                </p>
                            </div>
                        </div>
                        <br/>
                        <div t-if="doc.state not in ['draft','sent']" class="row">
                            <div class="col-6">
                                <p style="padding-right:20px;">
                                    <strong>
                                        <u t-translation="true">
                                        Delivery Address
                                    </u>
                                    </strong>
                                    <br/>
                                    <span t-field="doc.partner_shipping_id.name"/>
                                    <br/>
                                    <span>
                                        <t t-esc="doc.partner_shipping_id.street"/>
                                        <br/>
                                        <t t-esc="doc.partner_shipping_id.city"/>
                                        <t t-if='doc.partner_shipping_id.state_id' t-esc="doc.partner_shipping_id.state_id.name"/>
                                        <t t-if='doc.partner_shipping_id.country_id' t-esc="doc.partner_shipping_id.country_id.name"/>
                                    </span>
                                </p>
                            </div>
                            <div class="col-6">
                                <p style="padding-right:20px;">
                                    <strong>
                                        <u t-translation="true">
                                        Billing Address
                                    </u>
                                    </strong>
                                    <br/>
                                    <span t-field="doc.partner_shipping_id.name"/>
                                    <br/>
                                    <t t-esc="doc.partner_invoice_id.street"/>
                                    <br/>
                                    <t t-esc="doc.partner_invoice_id.city"/>
                                    <t t-if='doc.partner_invoice_id.state_id' t-esc="doc.partner_invoice_id.state_id.name"/>
                                    <t t-if='doc.partner_invoice_id.country_id' t-esc="doc.partner_invoice_id.country_id.name"/>
                                </p>
                            </div>
                        </div>
                        <br/>
                        <br/>
                        <div>
                            <t t-if="doc.state in ['draft','sent']">
                                <p t-translation="true">
                                    <t t-esc="doc.get_text_note_1()"/>
                                </p>
                            </t>
                            <t t-else="">
                                <p t-translation="true">
                                    <t t-esc="doc.get_text_note_2()"/>
                                </p>
                                <br/>
                                <br/>
                                <br/>
                                <br/>
                                <br/>
                                <br/>
            --------------------------------------------------------------------
                                <br/>
                                <span t-translation="true">Date, Name, and Signature</span>
                            </t>
                        </div>
                        <br/>
                        <br/>
                        <div>
                            <t t-esc="doc.user_id.name"/>
                        </div>
                    </div>
                    <!-- Purchase Order Further Information -->
                    <div t-if="'P' in doc.name and doc.other_delivery==True" class="row">
                        <div class="col-6">
                            <p>
                                <strong>
                                    <u t-translation="true">
                                   Further Information
                                </u>
                                </strong>
                                <br/>
                                <t t-esc="doc.delivery_address"/>
                            </p>
                        </div>
                    </div>
                    <div class="footer">
                        <div class="text-center">
                            <p class="footer-size" t-translation="true">
                            PFAU OG, COMPANY FOR OBJECT FURNISHING AND INTERIOR DESIGN, AM GESTADE 2-4, 1010 VIENNA
                                <br/>
                                <span class="footer-smallersize">PHONE: +43 -1- 535 40 75, WWW.PFAU1010.COM, OFFICE@PFAU1010.COM, VAT-NO. ATU 10249006, FN 9447v HG VIENNA
                                    <br/>
                            RAIFFEISENLANDESBANK NÖ-WIEN ACCOUNT NUM. 10.384.774, BANK CODE 32000, IBAN AT 8832 000 000 1038 4774, BIC RLNWATWW
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
                <!-- Invoice Report -->
                <div t-if="'WH/OUT/' not in doc.name and '/' in doc.name or 'I' in doc.name" t-attf-class="din_page quotation-page invoice_note article o_company_#{company.id}_layout {{'o_report_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  ''}} #{'din_page_pdf' if report_type == 'pdf' else ''}"
                    t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});"
                    t-att-data-oe-model="doc and doc._name"
                    t-att-data-oe-id="doc and doc.id">
                    <div class="title_source_div">
                        <strong class="title_source">
                            <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'" >
                                <span t-translation="true">Invoice</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'out_invoice' and o.state == 'draft'" >
                                <span t-translation="true">Draft Invoice</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'out_invoice' and o.state == 'cancel'">
                                <span t-translation="true">Cancelled Invoice</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'out_refund' and o.state == 'posted'">
                                <span t-translation="true">Credit Note</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'out_refund' and o.state == 'draft'">
                                <span t-translation="true">Draft Credit Note</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'out_refund' and o.state == 'cancel'">
                                <span t-translation="true">Cancelled Credit Note</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'in_refund'">
                                <span t-translation="true">Vendor Credit Note</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                            <span t-elif="o.move_type == 'in_invoice'">
                                <span t-translation="true">Vendor Credit Note</span>
                                <br/>
                                <span t-field="o.name"/>
                        </span>
                        </strong>
                    </div>
                    <div class="row information_block">
                        <div class="col-5 title" style="padding-right:20px;">
                            <strong>
                                <t t-if="doc.partner_id">
                                    <span t-field="doc.partner_id.name"/>
                                </t>
                            </strong>
                            <br/>
                            <span t-field="doc.partner_id.street"/>
                            <br/>
                            <span t-field="doc.partner_id.zip"/>
                            <span t-field="doc.partner_id.state_id.code"/>
                            <span t-field="doc.partner_id.city"/>
                            <br/>
                            <span t-field="doc.partner_id.country_id"/>
                            <t t-if='o.partner_id.vat'>
                                <span>VAT</span>:
                                <span t-field="o.partner_id.vat"/>
                            </t>
                        </div>
                        <div class="col-7">
                            <div class="row">
                                <!-- Right-aligned column -->
                                <div class="col-4 text-start">
                                    <!-- State-based labels -->
                                    <span>
                                        <span t-translation="true">Date</span>
                                        <br/>
                                    </span>
                                    <span t-if='doc.delivery_date'>
                                        <span t-translation="true">Delivery Date</span>
                                        <br/>
                                    </span>
                                    <span>
                                        <span t-translation="true">Sale Person</span>
                                        <br/>
                                    </span>
                                    <span t-if='doc.user_id.email'>
                                        <span t-translation="true">Email</span>
                                    </span>
                                </div>
                                <!-- Left-aligned column -->
                                <div class="col-6 text-start">
                                    <!-- Date based on state -->
                                    <span t-field="doc.invoice_date" t-options="{'widget':'date'}"/>
                                    <br/>
                                    <t t-if="doc.delivery_date">
                                        <span t-field="doc.delivery_date" t-options="{'widget':'date'}"/>
                                        <br/>
                                    </t>
                                    <span t-field="doc.user_id.name"/>
                                    <br/>
                                    <span t-if="doc.user_id.email">
                                        <span t-field="doc.user_id.email"/>
                                </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <br/>
                    <div class="row">
                        <div class="col-7">
                            <div class="row">
                                <div class="col-auto">
                                    <strong t-translation="true">
                                    Payment Date
                         
                                </strong>
                                    <p class="m-0" t-field="doc.invoice_date_due"/>
                                </div>
                                <div t-if='doc.invoice_origin' class="col-auto">
                                    <strong t-translation="true">
                                        Source
                                    </strong>
                                    <p class="m-0" t-field="doc.invoice_origin"/>
                                </div>
                                <div t-if="o.ref" class="col-auto">
                                    <strong t-translation="true">
                                   Reference
                                </strong>
                                    <p class="m-0" t-field="o.ref"/>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <br/>
                    <t t-set="display_discount" t-value="any(l.discount for l in doc.invoice_line_ids)"/>
                    <table class="table table-sm o_main_table table-borderless">
                        <thead style="border-bottom: 0.5px solid black;">
                            <tr>
                                <th class="text-start"
                                style="width:100px; border-top: 0px solid white !important; border-bottom: 1px solid black; width:50px;" t-translation="true">
                               Position
                               
                            </th>
                                <th class="text-start"
                                style="border-top: 0px solid white !important; border-bottom: 1px solid black;" t-translation="true">
                                Product
                            </th>
                                <th class="text-end"
                                style="border-top: 0px solid white !important; border-bottom: 1px solid black;"/>
                                <th class="text-end"
                                style="border-top: 0px solid white !important; border-bottom: 1px solid black;" t-translation="true">
                                Price/Unit
                            </th>
                                <th class="text-end"
                                style="border-top: 0px solid white !important; border-bottom: 1px solid black;" t-translation="true">
                                Quantity
                            </th>
                                <th t-if="display_discount" class="text-end"
                                style="border-top: 0px solid white !important; border-bottom: 1px solid black;" t-translation="true">
                                Disc.
                            </th>
                                <th class="text-end"
                                style="border-top: 0px solid white !important; border-bottom: 1px solid black;" t-translation="true">
                                Total
                            </th>
                            </tr>
                        </thead>
                        <tbody class="invoice_tbody">
                            <t t-set="current_subtotal" t-value="0"/>
                            <t t-set="index" t-value="0"/>
                            <t t-foreach="doc.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)" t-as="line" t-index="index">
                                <!-- Index add -->
                                <t t-set="index" t-value="index+1"/>
                                <t t-if="line.display_type=='product'">
                                    <tr t-if="line.price_unit &gt;= 0" t-attf-style="#{''if index == len(doc.invoice_line_ids) else 'border-bottom: 0.5px solid black;'} ">
                                        <td style="vertical-align: top;">
                                            <strong>
                                                <span t-if="'position' in line" t-field="line.position"/>
                                            </strong>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <t t-set="product_des" t-value="(line.name.split(']')[-1]).split(',') if ']' in line.name else line.name"/>
                                            <t t-foreach="product_des" t-as="des">
                                                <span t-esc="des"/>
                                                <br/>
                                            </t>
                                        </td>
                                        <td style="vertical-align: middle;">
                                            <img t-if="line.product_id.image_1920"
                                         t-att-src="image_data_uri(line.product_id.image_1920)" width="50px"
                                         height="50px"/>
                                        </td>
                                        <td class="text-end" style="text-align: center; vertical-align: middle;">
                                            <span>
                                                <span t-field="line.price_unit"/> €</span>
                                        </td>
                                        <td class="text-end" style="vertical-align: middle;">
                                            <t t-esc="int(line.quantity)"/>
                                        </td>
                                        <td t-if="display_discount" class="text-end" style="vertical-align: middle;">
                                            <span t-field="line.discount"/>%
                                        </td>
                                        <td class="text-end" style="vertical-align: middle;">
                                            <span t-field="line.price_subtotal"/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-elif="line.display_type == 'line_section'">
                                    <td colspan="99" t-attf-style="#{'' if index == len(doc.invoice_line_ids) else 'border-bottom: 0.5px solid black;'}">
                                        <span t-field="line.name" t-options="{'widget': 'text'}">A section title</span>
                                    </td>
                                    <t t-set="current_section" t-value="line"/>
                                    <t t-set="current_subtotal" t-value="0"/>
                                </t>
                                <t t-elif="line.display_type == 'line_note'" >
                                    <td colspan="99" t-attf-style="#{'' if index == len(doc.invoice_line_ids) else 'border-bottom: 0.5px solid black;'}">
                                        <span t-field="line.name" t-options="{'widget': 'text'}">A note, whose content usually applies to the section or product above.</span>
                                    </td>
                                </t>
                            </t>
                        </tbody>
                    </table>
                    <br/>
                    <br/>
                    <t t-set="discount"
                       t-value="sum(line.price_subtotal for line in doc.invoice_line_ids if line.price_subtotal and line.price_subtotal &lt; 0) or 0"/>
                    <t t-set="total_price"
                       t-value="sum(line.price_subtotal for line in doc.invoice_line_ids if line.price_subtotal and line.price_subtotal &gt; 0)"/>
                    <table class="table-sm o_main_table table-borderless" style="width:100%;">
                        <tr>
                            <td style="border-top: 0.5px solid black;">
                                <span t-translation="true">
                                Net Total
                            </span>
                            </td>
                            <td class="text-end" style="border-top: 0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(total_price).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr t-if="discount!=0">
                            <td style="border-top: 0.5px solid black;">
                                <span>
                                    <span t-translation="true">Conditions</span>
                                    <span t-esc="discount if discount==0 else round(abs(discount)/total_price*100)"/>%</span>
                            </td>
                            <td class="text-end" style="border-top:  0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(round(discount,2)).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr t-if="discount!=0">
                            <td style="border-top: 0.5px solid black;">
                                <span t-translation="true">
                                Subtotal
                            </span>
                            </td>
                            <td class="text-end" style="border-top:  0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(doc.amount_untaxed).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr t-if="doc.amount_tax>0">
                            <td style="border-top: 0.5px solid black;">
                                <span>20% Mwst.</span>
                            </td>
                            <td class="text-end" style="border-top: 0.5px solid black;">
                                <span>
                                    <t t-esc="'{:,.2f}'.format(doc.amount_tax).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                </span>
                            </td>
                        </tr>
                        <tr>
                            <td style="border-top: 0.5px solid black; border-bottom: 0.5px solid black;">
                                <strong>
                                    <span t-translation="true">
                                    Total
                                </span>
                                </strong>
                            </td>
                            <td class="text-end" style="border-top: 0.5px solid black; border-bottom: 0.5px solid black;">
                                <strong>
                                    <span>
                                        <t t-esc="'{:,.2f}'.format(doc.amount_total).replace(',', 'X').replace('.', ',').replace('X', '.')"/> €
                                    </span>
                                </strong>
                            </td>
                        </tr>
                    </table>
                    <br/>
                    <br/>
                    <div class="row pb-2">
                        <div class="col-3">
                            <p>
                                <strong style="padding-right:30px;" t-translation="true">
                                Payment Terms:
                            </strong>
                            </p>
                        </div>
                        <div class="col-9">
                            <p>
                                <t t-if="doc.invoice_payment_term_id" t-esc="doc.invoice_payment_term_id.name"/>
                                <t t-translation="true" t-esc="doc.invoice_note()"/>
                            </p>
                        </div>
                    </div>
                    <div class="footer">
                        <div class="text-center">
                            <p class="footer-size">
                            PFAU OG, COMPANY FOR OBJECT FURNISHING AND INTERIOR DESIGN, AM GESTADE 2-4, 1010 VIENNA
                                <br/>
                                <span class="footer-smallersize">PHONE: +43 -1- 535 40 75, WWW.PFAU1010.COM, OFFICE@PFAU1010.COM, VAT-NO. ATU 10249006, FN 9447v HG VIENNA
                                    <br/>
                            RAIFFEISENLANDESBANK NÖ-WIEN ACCOUNT NUM. 10.384.774, BANK CODE 32000, IBAN AT 8832 000 000 1038 4774, BIC RLNWATWW
                                </span>
                            </p>
                        </div>
                    </div>
                </div>
                <div t-if="'WH/OUT/' in doc.name" t-attf-class="din_page quotation-page invoice_note article o_company_#{company.id}_layout {{'o_report_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  ''}} #{'din_page_pdf' if report_type == 'pdf' else ''}"
                    t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});"
                    t-att-data-oe-model="doc and doc._name"
                    t-att-data-oe-id="doc and doc.id">
                    <t t-out="0"/>
                </div>
            </t>
        </xpath>
    </template>
</odoo>